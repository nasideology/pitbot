<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>–ü–∏—Ç–ë–æ—Ç - —Ä–∞—Å—á—ë—Ç</title>
  <style>
    body{font-family:Arial;background:#f7f7f7;padding:20px}
    input{width:100%;padding:8px;margin:6px 0}
    button{width:100%;padding:10px;background:#0d783b;color:#fff;border:0;border-radius:6px}
    #result{margin-top:15px;font-weight:bold;color:#222}
  </style>
</head>
<body>
  <h3>–†–∞—Å—Å—á–∏—Ç–∞—é –≤–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã</h3>
  <input id="weight" type="number" placeholder="–¢–µ–∫—É—â–∏–π –≤–µ—Å, –∫–≥">
  <input id="target" type="number" placeholder="–ñ–µ–ª–∞–µ–º—ã–π –≤–µ—Å, –∫–≥">
  <button onclick="calc()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
  <div id="result"></div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    function calc(){
  const w = Number(document.getElementById('weight').value);
  const t = Number(document.getElementById('target').value);
  if (!w || !t || w <= 0 || t <= 0) { alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤–µ—Å–∞'); return; }

  const delta = t - w;                      // + = –Ω–∞–±–æ—Ä, ‚àí = –ø–æ—Ö—É–¥–µ–Ω–∏–µ
  const goal  = delta > 0 ? 'gain' : 'lose';
  const kg    = Math.abs(delta);

  // 1. TDEE –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
  const activityFactor = goal === 'lose' ? 1.2 : 1.55;
  const tdee = (w * 24 + 200) * activityFactor;         // —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π TDEE
  const factor = goal === 'lose' ? 0.80 : 1.15;         // ‚àí20 % –∏–ª–∏ +15 %
  const kcalDaily = tdee * factor;            // –∏—Ç–æ–≥–æ–≤—ã–µ –∫–∫–∞–ª/–¥–µ–Ω—å

  // 2. –†–ï–ê–õ–¨–ù–´–ô –¥–µ—Ñ–∏—Ü–∏—Ç/–ø—Ä–æ—Ñ–∏—Ü–∏—Ç (–±–µ–∑ abs)
  const realDailyDelta = tdee - kcalDaily;                // –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏ lose, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏ gain

  // 3. –î–Ω–∏ = –æ–±—â–∏–π –æ–±—ä—ë–º / —Ä–µ–∞–ª—å–Ω—ã–π –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π —à–∞–≥
  const days = Math.round(kg * 7700 / Math.abs(realDailyDelta));

  // 4. –ö–∞–ª–æ—Ä–∏–∏ = –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –ü–û–°–õ–ï —É–º–Ω–æ–∂–µ–Ω–∏—è
  const kcalFinal = Math.round(kcalDaily);
      
  // 5. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
  document.getElementById('result').innerText =
    `üìÜ ${days} –¥–Ω–µ–π –¥–æ —Ü–µ–ª–∏\nüî• ${kcalFinal} –∫–∫–∞–ª/–¥–µ–Ω—å\nüìä –£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: ${
      goal === 'lose' ? '–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (–æ—Ñ–∏—Å, –±–µ–∑ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫)' : '—Å—Ä–µ–¥–Ω–∏–π (3‚Äì5 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫/–Ω–µ–¥–µ–ª—é)'
    }`;

  if (window.Telegram && window.Telegram.WebApp) {
    setTimeout(() => {
      Telegram.WebApp.sendData(JSON.stringify({days,kcal:kcalDaily,weight:w,target:t,goal,realDailyDelta}));
    }, 500);
  }
}
  </script>
</body>
</html>
