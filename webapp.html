<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>–ü–∏—Ç–ë–æ—Ç - —Ä–∞—Å—á—ë—Ç</title>
  <style>
    body{font-family:Arial;background:#f7f7f7;padding:20px}
    input{width:100%;padding:8px;margin:6px 0}
    button{width:100%;padding:10px;background:#ff6b00;color:#fff;border:0;border-radius:6px}
    #result{margin-top:15px;font-weight:bold;color:#222}
  </style>
</head>
<body>
  <h3>–†–∞—Å—Å—á–∏—Ç–∞—é –≤–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã</h3>
  <input id="weight" type="number" placeholder="–¢–µ–∫—É—â–∏–π –≤–µ—Å, –∫–≥">
  <input id="target" type="number" placeholder="–ñ–µ–ª–∞–µ–º—ã–π –≤–µ—Å, –∫–≥">
  <select id="goal">
    <option value="lose">–•–æ—á—É –ø–æ—Ö—É–¥–µ—Ç—å</option>
    <option value="gain">–•–æ—á—É –Ω–∞–±—Ä–∞—Ç—å</option>
  </select>
  <button onclick="calc()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
  <div id="result"></div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    function calc(){
      console.log('[calc] start');                // ‚Üê –æ—Ç–ª–∞–¥–∫–∞
      const w = Number(document.getElementById('weight').value);
      const t = Number(document.getElementById('target').value);
      const goal = document.getElementById('goal').value;
      console.log({w, t, goal});

      if (!w || !t || w <= 0 || t <= 0) {
        alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤–µ—Å–∞');
        return;
      }

      const kg = Math.abs(w - t);
      const tdee = (w * 24 + 200) * 1.4;                  // —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π TDEE
      const factor = goal === 'lose' ? 0.80 : 1.15;       // -20 % –∏–ª–∏ +15 %
      const dailyDelta = tdee * (factor - 1);             // –∑–Ω–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π
      const days = Math.round(kg * 7700 / Math.abs(dailyDelta));
      const kcal = Math.round(tdee * factor);

      console.log({days, kcal});                          // ‚Üê –æ—Ç–ª–∞–¥–∫–∞

      // 1. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º
      document.getElementById('result').innerText =
        `üìÜ ${days} –¥–Ω–µ–π –¥–æ —Ü–µ–ª–∏\nüî• ${kcal} –∫–∫–∞–ª/–¥–µ–Ω—å`;

      // 2. –ß–µ—Ä–µ–∑ 0,5 —Å–µ–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ—Ç—É
      if (window.Telegram && window.Telegram.WebApp) {
        setTimeout(() => {
          Telegram.WebApp.sendData(JSON.stringify({days,kcal,weight:w,target:t,goal}));
        }, 500);
      } else {
        console.warn('Telegram WebApp –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
      }
    }
  </script>
</body>
</html>
